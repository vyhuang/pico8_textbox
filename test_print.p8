pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
poke(0x5600,unpack(split"6,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,7,7,7,0,0,0,0,7,7,7,0,0,0,0,0,7,5,7,0,0,0,0,0,5,2,5,0,0,0,0,0,5,0,5,0,0,0,0,0,5,5,5,0,0,0,0,4,6,7,6,4,0,0,0,1,3,7,3,1,0,7,1,1,1,0,0,0,0,0,0,0,4,4,4,7,0,17,27,14,31,4,31,4,4,0,0,0,0,2,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,0,6,6,0,5,5,5,0,0,0,0,0,0,0,0,2,5,2,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,5,5,5,0,0,0,0,0,0,0,10,31,10,31,10,0,4,30,7,6,12,28,15,4,19,11,8,4,2,26,25,0,4,14,17,6,1,17,14,4,1,1,0,0,0,0,0,0,4,2,2,2,2,2,2,4,2,4,4,4,4,4,4,2,0,10,4,31,4,10,0,0,0,0,0,2,7,2,0,0,0,0,0,0,0,0,1,1,0,0,0,0,7,0,0,0,0,0,0,0,0,0,1,0,16,8,8,4,2,2,1,0,0,7,5,5,5,5,7,0,0,2,3,2,2,2,7,0,0,7,4,7,1,1,7,0,0,7,4,7,4,4,7,0,0,5,5,7,4,4,4,0,0,7,1,3,4,4,3,0,0,7,1,7,5,5,7,0,0,7,4,4,2,2,2,0,0,7,5,7,5,5,7,0,0,7,5,7,4,5,7,0,0,0,1,0,0,1,0,0,0,0,1,0,0,1,1,1,0,0,4,2,1,2,4,0,0,0,0,7,0,7,0,0,0,0,1,2,4,2,1,0,14,17,16,8,4,0,4,0,0,14,17,25,21,29,1,30,0,6,5,5,7,5,5,0,0,3,5,3,5,5,3,0,0,6,1,1,1,1,6,0,0,3,5,5,5,5,3,0,0,7,1,7,1,1,7,0,0,7,1,7,1,1,1,0,0,7,1,1,5,5,7,0,0,5,5,7,5,5,5,0,0,1,1,1,1,1,1,0,0,4,4,4,4,4,3,0,0,5,5,3,3,5,5,0,0,1,1,1,1,1,7,0,0,17,27,21,21,17,17,0,0,3,5,5,5,5,5,0,0,6,5,5,5,5,7,0,0,3,5,5,7,1,1,0,0,2,5,5,5,7,6,0,0,3,5,5,3,5,5,0,0,6,1,3,4,4,3,0,0,7,2,2,2,2,2,0,0,5,5,5,5,5,6,0,0,5,5,5,5,5,3,0,0,17,17,21,21,21,15,0,0,5,5,2,2,5,5,0,0,5,5,7,2,2,2,0,0,7,4,2,2,1,7,0,7,1,1,1,1,1,7,0,1,2,2,4,8,8,16,0,7,4,4,4,4,4,7,0,0,2,5,5,0,0,0,0,0,0,0,0,0,0,7,0,2,4,0,0,0,0,0,0,0,0,0,3,6,5,7,0,0,1,1,3,5,5,3,0,0,0,0,2,5,1,6,0,0,4,4,6,5,5,6,0,0,0,0,6,5,3,6,0,0,4,2,2,7,2,2,0,0,0,0,6,5,3,6,7,0,1,1,3,5,5,5,0,0,1,0,1,1,1,1,0,0,4,0,4,4,4,4,3,0,1,5,5,3,5,5,0,0,1,1,1,1,1,1,0,0,0,0,15,21,21,21,0,0,0,0,3,5,5,5,0,0,0,0,6,5,5,3,0,0,0,0,3,5,5,3,1,0,0,0,6,5,5,6,4,0,0,0,3,5,1,1,0,0,0,0,6,3,4,7,0,0,1,1,7,1,1,6,0,0,0,0,5,5,5,6,0,0,0,0,5,5,5,3,0,0,0,0,21,21,21,15,0,0,0,0,5,2,2,5,0,0,0,0,5,5,6,4,3,0,0,0,7,4,1,7,0,6,2,2,3,2,2,2,6,1,1,1,1,1,1,1,1,3,2,2,6,2,2,2,3,0,0,0,22,13,0,0,0,0,0,0,2,5,2,0,0,127,127,127,127,127,127,127,0,42,85,42,85,42,85,42,0,34,99,127,93,93,93,62,0,62,127,65,65,99,119,62,0,17,0,68,17,0,68,17,0,2,126,62,62,62,63,32,0,62,79,79,127,127,127,62,0,54,127,127,127,62,28,8,0,28,54,54,119,54,54,28,0,28,62,28,127,28,28,54,0,28,62,62,127,62,42,58,0,62,103,99,97,99,103,62,0,127,93,93,127,127,65,127,0,48,112,16,16,30,31,14,0,62,99,107,107,107,99,62,0,8,28,62,127,62,28,8,0,0,0,0,85,0,0,0,0,62,115,99,67,99,115,62,0,8,28,127,62,62,54,34,0,127,62,62,28,62,62,127,0,62,119,99,65,65,127,62,0,0,5,2,0,80,32,0,0,0,17,42,68,17,42,68,0,62,107,107,119,107,107,62,0,127,0,127,0,127,0,127,0,85,85,85,85,85,85,85,0"))

function pv_addSymbol(table, symbols, spacing)
    foreach(symbols, function(s) table[s] = spacing end)
end

pv_encoding = {}
pv_addSymbol(
    pv_encoding,
    split"0x1a,0x23,0x24,0x25,0x26,0x2a,0x2f,0x3f,0x40,0x4d,0x57,0x5c,0x6d,0x77,0x7e", 
    "\-g")
pv_addSymbol(
    pv_encoding,
    split"0x1b,0x1c,0x20,0x21,0x27,0x2c,0x2e,0x3a,0x3b,0x49,0x6c,0x69,0x7c", 
    "\-c") 

function pv_transformString(str)
    pv_result="\014"
    for i=1,#str do
        pv_char=ord(sub(str,i,i))
        pv_trailCode=pv_encoding[pv_char]
        if not pv_trailCode then
            pv_trailCode = "\-g"
            if pv_char <= 0xf then 
                pv_result = sub(pv_result,1,#pv_result-2)
            elseif pv_char < 0x80 then
                pv_trailCode = "\-e"
            end
        end
        pv_result = pv_result..chr(pv_char)..pv_trailCode
    end
end

function printv(str,x,y,c)
    pv_transformString(str)
    print(pv_result, x or @0x5f26, y or @0x5f27, c or color())
end

cls()
printv("The brown fox jumped over the lazy\ndog...\n\n"..
       "\"To be, or not to be? That is \nthe question--\\\n"..
       "Whether \'tis nobler in the mind to\nsuffer\\\n"..
       "The slings and arrows of outrageous\nfortune,\\\n"..
       "Or to take arms against a sea of \ntroubles,\\\n"..
       "And, by opposing, end them? To die,\nto sleep...\"")       
